// entry/src/main/ets/view/see/NavBar.ets
/**
 * æƒ³çœ‹é¡µé¢NavBarç»„ä»¶
 */
import { rvp } from '../../common/utils/DeviceScreen'
import { BarData } from '../../component/ScrollContainer'
import { router } from '@kit.ArkUI'

@Component
export struct NavBar {
  @StorageProp('topRectHeight')
  topRectHeight: number = 0
  @Prop barData: BarData

  // âœ… è·Ÿé¦–é¡µä¸€æ ·ï¼Œç»‘å®šå…¨å±€â€œæ˜¯å¦æœ‰æœªè¯»æ¶ˆæ¯â€çš„å¸ƒå°”å€¼
  @StorageLink('hasUnreadMessage')
  hasUnreadMessage: boolean = false

  build() {
    Row() {
      // å·¦ä¾§ï¼šé€šå‹¤åœ°å€
      Row({ space: rvp(16) }) {
        Image($r('app.media.bag'))
          .width(rvp(20))
          .height(rvp(20))
        Text('å¡«å†™é€šå‹¤åœ°å€')
          .fontSize(rvp(12))
          .fontWeight(500)
          .fontColor($r('app.color.black'))
      }

      // å³ä¾§ï¼šåªæœ‰ä¸€ä¸ªâ€œæ¶ˆæ¯â€æŒ‰é’®ï¼ˆå¸¦å°çº¢ç‚¹ï¼‰
      Column({ space: 1 }) {
        // å›¾æ ‡ + å°çº¢ç‚¹å åŠ 
        Stack() {
          Image($r('app.media.message'))
            .width(rvp(20))
            .height(rvp(20))
            .fillColor($r('app.color.black'))

          // ðŸ”´ å°çº¢ç‚¹ï¼šåªçœ‹ hasUnreadMessage
          if (this.hasUnreadMessage) {
            Column() { }
            .width(rvp(8))
            .height(rvp(8))
            .borderRadius(rvp(4))
            .backgroundColor('#FF3B30')
            .align(Alignment.TopEnd)
            .offset({ x: rvp(2), y: -rvp(2) })
          }
        }

        Text('æ¶ˆæ¯')
          .fontSize(rvp(10))
          .fontColor($r('app.color.black'))
      }
      // æ•´ä¸ªâ€œæ¶ˆæ¯â€åˆ—éƒ½å¯ç‚¹å‡»
      .onClick(() => {
        router.pushUrl({
          url: 'pages/ChatList'
        })
      })
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceBetween)
    .backgroundColor(this.barData.bgColor)
    .padding({
      left: 8,
      right: 8,
      top: 8 + this.topRectHeight,
      bottom: 8
    })
  }
}
